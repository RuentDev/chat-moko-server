generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextIndex", "fullTextSearch"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

enum MessageType {
  SINGLE_CHAT
  GROUP_CHAT
}

model User {
  id                String        @id @default(uuid()) @map("_id")
  email             String        @unique
  phone             String
  password          String?
  first_name        String?
  middle_name       String?
  last_name         String?
  verification_code String?
  is_active         Boolean       @default(false)
  is_reported       Boolean       @default(false)
  is_blocked        Boolean       @default(false)
  createdAt         DateTime      @default(now())
  updatedAt         DateTime?
  role              Role          @default(USER) // User role
  Conversation      Conversation? @relation(fields: [conversationId], references: [id])
  conversationId    String?
}

model Conversation {
  id           String    @id @default(uuid()) @map("_id")
  title        String? // Title of the conversation (optional)
  creatorId    String // ID of the conversation creator
  createdAt    DateTime  @default(now())
  updatedAt    DateTime?
  deletedAt    DateTime?
  participants User[]
  messages     Message[]
}

model Message {
  id                   String        @id @default(uuid()) @map("_id")
  type                 MessageType   @default(SINGLE_CHAT) // Message type
  content              String
  attachment_thumb_url String? // Thumbnail URL for attachments (optional)
  attachment_url       String? // Attachment URL (optional)
  createdAt            DateTime      @default(now())
  updatedAt            DateTime?
  deletedAt            DateTime?
  conversation         Conversation? @relation(fields: [conversationId], references: [id])
  conversationId       String?
}
